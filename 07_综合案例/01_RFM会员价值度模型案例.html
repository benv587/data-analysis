
<!doctype html>
<html lang="zh" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      <link rel="icon" href="../img/logo.png">
      <meta name="generator" content="mkdocs-1.2.3, mkdocs-material-8.1.6">
    
    
      
        <title>1 RFM会员价值度模型案例 - 数据处理与统计分析 V3.0</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.cd566b2a.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.e6a45f82.min.css">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("..",location),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="none" data-md-color-accent="none">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#1-rfm" class="md-skip">
          跳转至
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="页眉">
    <a href=".." title="数据处理与统计分析 V3.0" class="md-header__button md-logo" aria-label="数据处理与统计分析 V3.0" data-md-component="logo">
      
  <img src="../img/logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            数据处理与统计分析 V3.0
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              1 RFM会员价值度模型案例
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="搜索" placeholder="搜索" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="查找">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="清空当前内容" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            正在初始化搜索引擎
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
    <img src="../assets/images/logo.svg" height="45px" alt="logo">

  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="导航栏" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="数据处理与统计分析 V3.0" class="md-nav__button md-logo" aria-label="数据处理与统计分析 V3.0" data-md-component="logo">
      
  <img src="../img/logo.png" alt="logo">

    </a>
    数据处理与统计分析 V3.0
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1" type="checkbox" id="__nav_1" >
      
      
      
      
        <label class="md-nav__link" for="__nav_1">
          第一章 Linux
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="第一章 Linux" data-md-level="1">
        <label class="md-nav__title" for="__nav_1">
          <span class="md-nav__icon md-icon"></span>
          第一章 Linux
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../01_Linux%E8%AE%B2%E4%B9%89/01_Linux%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F.html" class="md-nav__link">
        1 Linux操作系统
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../01_Linux%E8%AE%B2%E4%B9%89/02_Linux%E7%B3%BB%E7%BB%9F%E9%AB%98%E7%BA%A7.html" class="md-nav__link">
        2 Linux系统高级
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" type="checkbox" id="__nav_2" >
      
      
      
      
        <label class="md-nav__link" for="__nav_2">
          第二章 MySQL
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="第二章 MySQL" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          第二章 MySQL
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../02_MySQL%E8%AE%B2%E4%B9%89/MySQL%E6%95%B0%E6%8D%AE%E5%BA%93%E5%9F%BA%E7%A1%801.html" class="md-nav__link">
        1 MySQL数据库基础I
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../02_MySQL%E8%AE%B2%E4%B9%89/MySQL%E6%95%B0%E6%8D%AE%E5%BA%93%E5%9F%BA%E7%A1%802.html" class="md-nav__link">
        2 MySQL数据库基础II
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../02_MySQL%E8%AE%B2%E4%B9%89/MySQL%E6%95%B0%E6%8D%AE%E5%BA%93%E9%AB%98%E7%BA%A7.html" class="md-nav__link">
        3 MySQL高级
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" >
      
      
      
      
        <label class="md-nav__link" for="__nav_3">
          第三章 环境搭建
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="第三章 环境搭建" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          第三章 环境搭建
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../03_%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/01_%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA.html" class="md-nav__link">
        1 环境搭建及使用
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4">
          第四章 NumPy
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="第四章 NumPy" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          第四章 NumPy
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../04_NumPy%E8%AE%B2%E4%B9%89/01_NumPy%E8%AE%B2%E4%B9%89.html" class="md-nav__link">
        1 NumPy
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../04_NumPy%E8%AE%B2%E4%B9%89/02_%E5%B8%B8%E7%94%A8%E6%A6%82%E5%BF%B5.html" class="md-nav__link">
        2 常用概念
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5" type="checkbox" id="__nav_5" >
      
      
      
      
        <label class="md-nav__link" for="__nav_5">
          第五章 Pandas
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="第五章 Pandas" data-md-level="1">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          第五章 Pandas
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../05_Pandas%E8%AE%B2%E4%B9%89/01_Python%E6%95%B0%E6%8D%AE%E5%A4%84%E7%90%86%E7%AE%80%E4%BB%8B.html" class="md-nav__link">
        1 Python 数据分析处理简介
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../05_Pandas%E8%AE%B2%E4%B9%89/02_Pandas_%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84.html" class="md-nav__link">
        2 Pandas 数据结构
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../05_Pandas%E8%AE%B2%E4%B9%89/03_Pandas_DataFrame%E5%85%A5%E9%97%A8.html" class="md-nav__link">
        3 Pandas DataFrame 入门
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../05_Pandas%E8%AE%B2%E4%B9%89/04_Pandas%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E5%85%A5%E9%97%A8.html" class="md-nav__link">
        4 Pandas 数据分析入门
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../05_Pandas%E8%AE%B2%E4%B9%89/05_%E6%95%B0%E6%8D%AE%E7%BB%84%E5%90%88.html" class="md-nav__link">
        5 数据组合
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../05_Pandas%E8%AE%B2%E4%B9%89/06_%E6%95%B0%E6%8D%AE%E6%B8%85%E6%B4%97.html" class="md-nav__link">
        6 数据清洗
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../05_Pandas%E8%AE%B2%E4%B9%89/07_apply%E8%87%AA%E5%AE%9A%E4%B9%89%E5%87%BD%E6%95%B0.html" class="md-nav__link">
        7 apply 自定义函数
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../05_Pandas%E8%AE%B2%E4%B9%89/08_%E6%95%B0%E6%8D%AE%E5%88%86%E7%BB%84.html" class="md-nav__link">
        8 数据分组
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../05_Pandas%E8%AE%B2%E4%B9%89/09_%E6%95%B0%E6%8D%AE%E9%80%8F%E8%A7%86%E8%A1%A8.html" class="md-nav__link">
        9 数据透视表
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../05_Pandas%E8%AE%B2%E4%B9%89/10_datetime%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B.html" class="md-nav__link">
        10 datetime 数据类型
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_6" type="checkbox" id="__nav_6" >
      
      
      
      
        <label class="md-nav__link" for="__nav_6">
          第六章 数据分析绘图
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="第六章 数据分析绘图" data-md-level="1">
        <label class="md-nav__title" for="__nav_6">
          <span class="md-nav__icon md-icon"></span>
          第六章 数据分析绘图
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../06_%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E7%BB%98%E5%9B%BE/01_%E6%95%B0%E6%8D%AE%E5%8F%AF%E8%A7%86%E5%8C%96%E4%BB%8B%E7%BB%8D.html" class="md-nav__link">
        1 Python数据可视化
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../06_%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E7%BB%98%E5%9B%BE/02_Matplotlib%E7%BB%98%E5%9B%BE.html" class="md-nav__link">
        2 Matplotlib绘图
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../06_%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E7%BB%98%E5%9B%BE/03_Pandas%E7%BB%98%E5%9B%BE.html" class="md-nav__link">
        3 Pandas绘图
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../06_%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E7%BB%98%E5%9B%BE/04_Seaborn%E7%BB%98%E5%9B%BE.html" class="md-nav__link">
        4 Seaborn 可视化
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7" type="checkbox" id="__nav_7" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_7">
          第七章 综合案例
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="第七章 综合案例" data-md-level="1">
        <label class="md-nav__title" for="__nav_7">
          <span class="md-nav__icon md-icon"></span>
          第七章 综合案例
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          1 RFM会员价值度模型案例
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="01_RFM%E4%BC%9A%E5%91%98%E4%BB%B7%E5%80%BC%E5%BA%A6%E6%A8%A1%E5%9E%8B%E6%A1%88%E4%BE%8B.html" class="md-nav__link md-nav__link--active">
        1 RFM会员价值度模型案例
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="目录">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      目录
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    学习目标
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#1" class="md-nav__link">
    1 会员价值度模型介绍
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-rfm" class="md-nav__link">
    2 RFM计算案例
  </a>
  
    <nav class="md-nav" aria-label="2 RFM计算案例">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#21" class="md-nav__link">
    2.1 案例背景
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#22" class="md-nav__link">
    2.2 用到的技术点
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#23" class="md-nav__link">
    2.3 案例数据
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#24" class="md-nav__link">
    2.4 代码
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#25" class="md-nav__link">
    2.5 案例结论
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#26" class="md-nav__link">
    2.6 案例应用
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#27" class="md-nav__link">
    2.7 案例注意点
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    小结
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="目录">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      目录
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    学习目标
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#1" class="md-nav__link">
    1 会员价值度模型介绍
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-rfm" class="md-nav__link">
    2 RFM计算案例
  </a>
  
    <nav class="md-nav" aria-label="2 RFM计算案例">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#21" class="md-nav__link">
    2.1 案例背景
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#22" class="md-nav__link">
    2.2 用到的技术点
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#23" class="md-nav__link">
    2.3 案例数据
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#24" class="md-nav__link">
    2.4 代码
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#25" class="md-nav__link">
    2.5 案例结论
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#26" class="md-nav__link">
    2.6 案例应用
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#27" class="md-nav__link">
    2.7 案例注意点
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    小结
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                

<h1 id="1-rfm">1 RFM会员价值度模型案例<a class="headerlink" href="#1-rfm" title="Permanent link">&para;</a></h1>
<h2 id="_1">学习目标<a class="headerlink" href="#_1" title="Permanent link">&para;</a></h2>
<ul>
<li>知道RFM模型的概念和使用方法</li>
<li>掌握如何使用Python进行RFM分群</li>
<li>知道如何使用Pyecharts绘制3D图形</li>
</ul>
<h2 id="1">1 会员价值度模型介绍<a class="headerlink" href="#1" title="Permanent link">&para;</a></h2>
<ul>
<li>
<p>会员价值度用来评估用户的价值情况，是区分会员价值的重要模型和参考依据，也是衡量不同营销效果的关键指标之一。</p>
</li>
<li>
<p>价值度模型一般基于交易行为产生，衡量的是有实体转化价值的行为。常用的价值度模型是RFM</p>
</li>
<li>
<p>RFM模型是根据会员</p>
<ul>
<li>最近一次购买时间R（Recency）</li>
<li>购买频率F（Frequency）</li>
<li>购买金额M（Monetary）计算得出RFM得分</li>
<li>通过这3个维度来评估客户的订单活跃价值，常用来做客户分群或价值区分</li>
<li>RFM模型基于一个固定时间点来做模型分析，不同时间计算的的RFM结果可能不一样</li>
</ul>
<table>
<thead>
<tr>
<th>R</th>
<th>F</th>
<th>M</th>
<th>用户类别</th>
</tr>
</thead>
<tbody>
<tr>
<td>高</td>
<td>高</td>
<td>高</td>
<td>重要价值用户</td>
</tr>
<tr>
<td>高</td>
<td>低</td>
<td>高</td>
<td>重要发展用户</td>
</tr>
<tr>
<td>低</td>
<td>高</td>
<td>高</td>
<td>重要保持用户</td>
</tr>
<tr>
<td>低</td>
<td>低</td>
<td>高</td>
<td>重要挽留用户</td>
</tr>
<tr>
<td>高</td>
<td>高</td>
<td>低</td>
<td>一般价值用户</td>
</tr>
<tr>
<td>高</td>
<td>低</td>
<td>低</td>
<td>一般发展用户</td>
</tr>
<tr>
<td>低</td>
<td>高</td>
<td>低</td>
<td>一般保持用户</td>
</tr>
<tr>
<td>低</td>
<td>低</td>
<td>低</td>
<td>一般挽留用户</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>RFM模型的基本实现过程：</p>
<ul>
<li>①设置要做计算时的截止时间节点（例如2017-5-30），用来做基于该时间的数据选取和计算。</li>
<li>②在会员数据库中，以今天为时间界限向前推固定周期（例如1年），得到包含每个会员的会员ID、订单时间、订单金额的原始数据集。一个会员可能会产生多条订单记录。</li>
<li>③ 数据预计算。从订单时间中找到各个会员距离截止时间节点最近的订单时间作为最近购买时间；以会员ID为维度统计每个用户的订单数量作为购买频率；将用户多个订单的订单金额求和得到总订单金额。由此得到R、F、M三个原始数据量。</li>
<li>④ R、F、M分区。对于F和M变量来讲，值越大代表购买频率越高、订单金额越高；但对R来讲，值越小代表离截止时间节点越近，因此值越好。对R、F、M分别使用五分位（三分位也可以，分位数越多划分得越详细）法做数据分区。需要注意的是，对于R来讲需要倒过来划分，离截止时间越近的值划分越大。这样就得到每个用户的R、F、M三个变量的分位数值。</li>
<li>⑤ 将3个值组合或相加得到总的RFM得分。对于RFM总得分的计算有两种方式，一种是直接将3个值拼接到一起，例如RFM得分为312、333、132；另一种是直接将3个值相加求得一个新的汇总值，例如RFM得分为6、9、6。</li>
</ul>
</li>
<li>
<p>Excel实现RFM划分案例</p>
<ul>
<li>
<p>以某电商公司为例</p>
<ul>
<li>R：例如：正常新用户注册1周内交易，7天是重要的值，日用品采购周期是1个月，30天是重要的值</li>
<li>F：例如：1次购买，2次购买，3次购买，4~10次，10次以上</li>
<li>M：例如：客单价300，热销单品价格240 等</li>
</ul>
</li>
<li>
<p>常见的确定RFM划分区间的套路</p>
<ul>
<li>业务实际判断</li>
<li>平均值或中位数</li>
<li>二八法则</li>
</ul>
</li>
<li>
<p>提取用户最近一次的交易时间，算出距离计算时间的差值</p>
<ul>
<li>获取当前时间=TODAY()</li>
</ul>
<p><img alt="image-20191123211908956" src="img/rfm1.png" /></p>
<ul>
<li>计算时间间隔</li>
</ul>
<p><img alt="image-20191123212035183" src="img/rfm2.png" /></p>
</li>
<li>
<p>根据天数长短赋予对应的R值</p>
<ul>
<li>=IF(D2&gt;60,1,IF(D2&gt;30,2,IF(D2&gt;14,3,IF(D2&gt;7,4,5))))</li>
</ul>
<p><img alt="image-20191123212348872" src="img/rfm3.png" /></p>
</li>
<li>
<p>从历史数据中取出所有用户的购买次数，根据次数多少赋予对应的F分值</p>
<ul>
<li>=IF(E2&gt;10,5,IF(E2&gt;3,4,IF(E2&gt;2,3,IF(E2&gt;1,2,1))))</li>
</ul>
<p><img alt="image-20191123212845505" src="img/rfm4.png" /></p>
</li>
<li>
<p>从历史数据中汇总，求得该用户的交易总额，根据金额大小赋予对应的M值</p>
<ul>
<li>=IF(F2&gt;1000,5,IF(F2&gt;500,4,IF(F2&gt;300,3,IF(F2&gt;230,2,1))))</li>
<li><img alt="image-20191123213158642" src="img/rfm5.png" /></li>
</ul>
</li>
<li>
<p>求出RFM的中值，例如中位数，用中值和用户的实际三值进行比较，高于中值的为高，否则为低</p>
<p><img alt="image-20191123214208118" src="img/rfm6.png" /></p>
</li>
</ul>
</li>
<li>
<p>在得到不同会员的RFM之后，根据步骤⑤产生的两种结果有两种应用思路</p>
<ul>
<li>思路1：基于3个维度值做用户群体划分和解读，对用户的价值度做分析<ul>
<li>得分为212的会员往往购买频率较低，针对购买频率低的客户应定期发送促销活动邮件</li>
<li>得分为321的会员虽然购买频率高但是订单金额低等，这些客户往往具有较高的购买黏性，可以考虑通过关联或搭配销售的方式提升订单金额。</li>
</ul>
</li>
<li>思路2：基于RFM的汇总得分评估所有会员的价值度价值，并可以做价值度排名。同时，该得分还可以作为输入维度与其他维度一起作为其他数据分析和挖掘模型的输入变量，为分析建模提供基础。</li>
</ul>
</li>
</ul>
<h2 id="2-rfm">2 RFM计算案例<a class="headerlink" href="#2-rfm" title="Permanent link">&para;</a></h2>
<h3 id="21">2.1 案例背景<a class="headerlink" href="#21" title="Permanent link">&para;</a></h3>
<ul>
<li>用户价值细分是了解用户价值度的重要途径，针对交易数据分析的常用模型是RFM模型</li>
<li>业务对RFM的结果要求<ul>
<li>对用户做分组</li>
<li>将每个组的用户特征概括和总结出来，便于后续精细化运营不同的客户群体，且根据不同群体做定制化或差异性的营销和关怀</li>
</ul>
</li>
<li>
<p>规划目标将RFM的3个维度分别做3个区间的离散化</p>
<ul>
<li>用户群体最大有3×3×3=27个</li>
<li>划分区间过多则不利于用户群体的拆分</li>
<li>区间过少则可能导致每个特征上的用户区分不显著</li>
</ul>
</li>
<li>
<p>交付结果</p>
<ul>
<li>给业务部门做运营的分析结果要导出为Excel文件，用于做后续分析和二次加工使用</li>
<li>RFM的结果还会供其他模型的建模使用，RFM本身的结果可以作为新的局部性特征，因此数据的输出需要有本地文件</li>
</ul>
</li>
<li>数据说明<ul>
<li>选择近4年订单数据，从不同的年份对比不同时间下各个分组的绝对值变化情况，方便了解会员的波动</li>
<li>案例的输入源数据sales.xlsx</li>
<li>程序输出RFM得分数据写入本地文件sales_rfm_score.xlsx和MySQL数据库sales_rfm_score表中</li>
</ul>
</li>
</ul>
<h3 id="22">2.2 用到的技术点<a class="headerlink" href="#22" title="Permanent link">&para;</a></h3>
<ul>
<li>通过Python代码手动实现RFM模型，主要用到的库包括<ul>
<li>time、numpy和pandas</li>
<li>在结果展示时使用了pyecharts的3D柱形图</li>
</ul>
</li>
</ul>
<h3 id="23">2.3 案例数据<a class="headerlink" href="#23" title="Permanent link">&para;</a></h3>
<ul>
<li>
<p>案例数据是某企业从2015年到2018年共4年的用户订单抽样数据，数据来源于销售系统</p>
</li>
<li>
<p>数据在Excel中包含5个sheet，前4个sheet以年份为单位存储为单个sheet中，最后一张会员等级表为用户的等级表</p>
</li>
<li>
<p>前4张表的数据概要如下。</p>
<ul>
<li>
<p>特征变量数：4</p>
</li>
<li>
<p>数据记录数：30774/41278/50839/81349</p>
</li>
<li>
<p>是否有NA值：有</p>
</li>
<li>
<p>是否有异常值：有</p>
<p>·会员ID：每个会员的ID唯一，由纯数字组成。
·提交日期：订单日提交日期。
·订单号：订单ID，每个订单的ID唯一，由纯数字组成。
·订单金额：订单金额，浮点型数据。</p>
</li>
</ul>
</li>
<li>
<p>具体数据特征如下：</p>
<ul>
<li>会员ID：每个会员的ID唯一，整型</li>
<li>提交日期：订单日提交日期</li>
<li>订单号：订单ID，每个订单的ID唯一，整型</li>
<li>订单金额：订单金额，浮点型数据</li>
</ul>
</li>
<li>
<p>会员登记表中是所有会员的会员ID对应会员等级的情况，包括以下两个字段</p>
<ul>
<li>会员ID：该ID可与前面的订单表中的会员ID关联</li>
<li>会员等级：会员等级以数字区分，数字越大，级别越高</li>
</ul>
</li>
</ul>
<h3 id="24">2.4 代码<a class="headerlink" href="#24" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>安装所需python库</strong></li>
</ul>
<div class="highlight"><pre><span></span><code>pip install pymysql pyecharts
</code></pre></div>
<ul>
<li><strong>导入模块</strong></li>
</ul>
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">time</span>  <span class="c1"># 时间库</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>  <span class="c1"># numpy库</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>  <span class="c1"># pandas库</span>
<span class="kn">import</span> <span class="nn">pymysql</span>  <span class="c1"># mysql连接库</span>

<span class="kn">from</span> <span class="nn">pyecharts.charts</span> <span class="kn">import</span> <span class="n">Bar3D</span> <span class="c1"># 3D柱形图</span>
</code></pre></div>
<ul>
<li>
<p>用到了6个库：time、numpy、pandas、pymysql、pyecharts。</p>
<ul>
<li>time：用来记录插入数据库时的当前日期</li>
<li>numpy：用来做基本数据处理等</li>
<li>pandas：有关日期转换、数据格式化处理、主要RFM计算过程等</li>
<li>pymysql：数据库连接工具，读写MySQL数据库。</li>
<li>pyecharts：展示3D柱形图</li>
</ul>
</li>
<li>
<p><strong>读取数据</strong></p>
</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="n">sheet_names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;2015&#39;</span><span class="p">,</span><span class="s1">&#39;2016&#39;</span><span class="p">,</span><span class="s1">&#39;2017&#39;</span><span class="p">,</span><span class="s1">&#39;2018&#39;</span><span class="p">,</span><span class="s1">&#39;会员等级&#39;</span><span class="p">]</span>
<span class="n">sheet_datas</span> <span class="o">=</span> <span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="s1">&#39;data/sales.xlsx&#39;</span><span class="p">,</span><span class="n">sheet_name</span><span class="o">=</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">sheet_names</span><span class="p">]</span>
</code></pre></div>
<ul>
<li><strong>查看数据基本情况</strong></li>
</ul>
<div class="highlight"><pre><span></span><code><span class="k">for</span> <span class="n">each_name</span><span class="p">,</span><span class="n">each_data</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">sheet_names</span><span class="p">,</span><span class="n">sheet_datas</span><span class="p">):</span>    
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;[data summary for =============</span><span class="si">{}</span><span class="s1">===============]&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">each_name</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Overview:&#39;</span><span class="p">,</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span><span class="n">each_data</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span><span class="c1"># 展示数据前4条</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;DESC:&#39;</span><span class="p">,</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span><span class="n">each_data</span><span class="o">.</span><span class="n">describe</span><span class="p">())</span><span class="c1"># 数据描述性信息</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;NA records&#39;</span><span class="p">,</span><span class="n">each_data</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span> <span class="c1"># 缺失值记录数    </span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Dtypes&#39;</span><span class="p">,</span><span class="n">each_data</span><span class="o">.</span><span class="n">dtypes</span><span class="p">)</span> <span class="c1"># 数据类型</span>
</code></pre></div>
<blockquote>
<p><font color='red'>输出结果：</font></p>
<div class="highlight"><pre><span></span><code><span class="o">[</span>data summary <span class="k">for</span> <span class="o">=============</span><span class="nv">2015</span><span class="o">===============]</span>
Overview: 
           会员ID         订单号       提交日期    订单金额
<span class="m">0</span>  <span class="m">15278002468</span>  <span class="m">3000304681</span> <span class="m">2015</span>-01-01   <span class="m">499</span>.0
<span class="m">1</span>  <span class="m">39236378972</span>  <span class="m">3000305791</span> <span class="m">2015</span>-01-01  <span class="m">2588</span>.0
<span class="m">2</span>  <span class="m">38722039578</span>  <span class="m">3000641787</span> <span class="m">2015</span>-01-01   <span class="m">498</span>.0
<span class="m">3</span>  <span class="m">11049640063</span>  <span class="m">3000798913</span> <span class="m">2015</span>-01-01  <span class="m">1572</span>.0
DESC: 
                会员ID           订单号           订单金额
count  <span class="m">3</span>.077400e+04  <span class="m">3</span>.077400e+04   <span class="m">30774</span>.000000
mean   <span class="m">2</span>.918779e+10  <span class="m">4</span>.020414e+09     <span class="m">960</span>.991161
std    <span class="m">1</span>.385333e+10  <span class="m">2</span>.630510e+08    <span class="m">2068</span>.107231
min    <span class="m">2</span>.670000e+02  <span class="m">3</span>.000305e+09       <span class="m">0</span>.500000
<span class="m">25</span>%    <span class="m">1</span>.944122e+10  <span class="m">3</span>.885510e+09      <span class="m">59</span>.000000
<span class="m">50</span>%    <span class="m">3</span>.746545e+10  <span class="m">4</span>.117491e+09     <span class="m">139</span>.000000
<span class="m">75</span>%    <span class="m">3</span>.923593e+10  <span class="m">4</span>.234882e+09     <span class="m">899</span>.000000
max    <span class="m">3</span>.954613e+10  <span class="m">4</span>.282025e+09  <span class="m">111750</span>.000000
NA records <span class="m">0</span>
Dtypes 会员ID             int64
订单号              int64
提交日期    datetime64<span class="o">[</span>ns<span class="o">]</span>
订单金额           float64
dtype: object
<span class="o">[</span>data summary <span class="k">for</span> <span class="o">=============</span><span class="nv">2016</span><span class="o">===============]</span>
Overview: 
           会员ID         订单号       提交日期    订单金额
<span class="m">0</span>  <span class="m">39288120141</span>  <span class="m">4282025766</span> <span class="m">2016</span>-01-01    <span class="m">76</span>.0
<span class="m">1</span>  <span class="m">39293812118</span>  <span class="m">4282037929</span> <span class="m">2016</span>-01-01  <span class="m">7599</span>.0
<span class="m">2</span>  <span class="m">27596340905</span>  <span class="m">4282038740</span> <span class="m">2016</span>-01-01   <span class="m">802</span>.0
<span class="m">3</span>  <span class="m">15111475509</span>  <span class="m">4282043819</span> <span class="m">2016</span>-01-01    <span class="m">65</span>.0
DESC: 
                会员ID           订单号           订单金额
count  <span class="m">4</span>.127800e+04  <span class="m">4</span>.127800e+04   <span class="m">41277</span>.000000
mean   <span class="m">2</span>.908415e+10  <span class="m">4</span>.313583e+09     <span class="m">957</span>.106694
std    <span class="m">1</span>.389468e+10  <span class="m">1</span>.094572e+07    <span class="m">2478</span>.560036
min    <span class="m">8</span>.100000e+01  <span class="m">4</span>.282026e+09       <span class="m">0</span>.100000
<span class="m">25</span>%    <span class="m">1</span>.934990e+10  <span class="m">4</span>.309457e+09      <span class="m">59</span>.000000
<span class="m">50</span>%    <span class="m">3</span>.730339e+10  <span class="m">4</span>.317545e+09     <span class="m">147</span>.000000
<span class="m">75</span>%    <span class="m">3</span>.923182e+10  <span class="m">4</span>.321132e+09     <span class="m">888</span>.000000
max    <span class="m">3</span>.954554e+10  <span class="m">4</span>.324911e+09  <span class="m">174900</span>.000000
NA records <span class="m">1</span>
Dtypes 会员ID             int64
订单号              int64
提交日期    datetime64<span class="o">[</span>ns<span class="o">]</span>
订单金额           float64
dtype: object
<span class="o">[</span>data summary <span class="k">for</span> <span class="o">=============</span><span class="nv">2017</span><span class="o">===============]</span>
Overview: 
           会员ID         订单号       提交日期    订单金额
<span class="m">0</span>  <span class="m">38765290840</span>  <span class="m">4324911135</span> <span class="m">2017</span>-01-01  <span class="m">1799</span>.0
<span class="m">1</span>  <span class="m">39305832102</span>  <span class="m">4324911213</span> <span class="m">2017</span>-01-01   <span class="m">369</span>.0
<span class="m">2</span>  <span class="m">34190994969</span>  <span class="m">4324911251</span> <span class="m">2017</span>-01-01   <span class="m">189</span>.0
<span class="m">3</span>  <span class="m">38986333210</span>  <span class="m">4324911283</span> <span class="m">2017</span>-01-01   <span class="m">169</span>.0
DESC: 
                会员ID           订单号           订单金额
count  <span class="m">5</span>.083900e+04  <span class="m">5</span>.083900e+04   <span class="m">50839</span>.000000
mean   <span class="m">2</span>.882368e+10  <span class="m">4</span>.332466e+09     <span class="m">963</span>.587872
std    <span class="m">1</span>.409416e+10  <span class="m">4</span>.404350e+06    <span class="m">2178</span>.727261
min    <span class="m">2</span>.780000e+02  <span class="m">4</span>.324911e+09       <span class="m">0</span>.300000
<span class="m">25</span>%    <span class="m">1</span>.869274e+10  <span class="m">4</span>.328415e+09      <span class="m">59</span>.000000
<span class="m">50</span>%    <span class="m">3</span>.688044e+10  <span class="m">4</span>.331989e+09     <span class="m">149</span>.000000
<span class="m">75</span>%    <span class="m">3</span>.923020e+10  <span class="m">4</span>.337515e+09     <span class="m">898</span>.000000
max    <span class="m">3</span>.954554e+10  <span class="m">4</span>.338764e+09  <span class="m">123609</span>.000000
NA records <span class="m">0</span>
Dtypes 会员ID             int64
订单号              int64
提交日期    datetime64<span class="o">[</span>ns<span class="o">]</span>
订单金额           float64
dtype: object
<span class="o">[</span>data summary <span class="k">for</span> <span class="o">=============</span><span class="nv">2018</span><span class="o">===============]</span>
Overview: 
           会员ID         订单号       提交日期    订单金额
<span class="m">0</span>  <span class="m">39229691808</span>  <span class="m">4338764262</span> <span class="m">2018</span>-01-01  <span class="m">3646</span>.0
<span class="m">1</span>  <span class="m">39293668916</span>  <span class="m">4338764363</span> <span class="m">2018</span>-01-01  <span class="m">3999</span>.0
<span class="m">2</span>  <span class="m">35059646224</span>  <span class="m">4338764376</span> <span class="m">2018</span>-01-01    <span class="m">10</span>.1
<span class="m">3</span>      <span class="m">1084397</span>  <span class="m">4338770013</span> <span class="m">2018</span>-01-01   <span class="m">828</span>.0
DESC: 
                会员ID           订单号           订单金额
count  <span class="m">8</span>.134900e+04  <span class="m">8</span>.134900e+04   <span class="m">81348</span>.000000
mean   <span class="m">2</span>.902317e+10  <span class="m">4</span>.348372e+09     <span class="m">966</span>.582792
std    <span class="m">1</span>.404116e+10  <span class="m">4</span>.183774e+06    <span class="m">2204</span>.969534
min    <span class="m">2</span>.780000e+02  <span class="m">4</span>.338764e+09       <span class="m">0</span>.000000
<span class="m">25</span>%    <span class="m">1</span>.902755e+10  <span class="m">4</span>.345654e+09      <span class="m">60</span>.000000
<span class="m">50</span>%    <span class="m">3</span>.740121e+10  <span class="m">4</span>.349448e+09     <span class="m">149</span>.000000
<span class="m">75</span>%    <span class="m">3</span>.923380e+10  <span class="m">4</span>.351639e+09     <span class="m">899</span>.000000
max    <span class="m">3</span>.954614e+10  <span class="m">4</span>.354235e+09  <span class="m">174900</span>.000000
NA records <span class="m">1</span>
Dtypes 会员ID             int64
订单号              int64
提交日期    datetime64<span class="o">[</span>ns<span class="o">]</span>
订单金额           float64
dtype: object
<span class="o">[</span>data summary <span class="k">for</span> <span class="o">=============</span><span class="nv">会员等级</span><span class="o">===============]</span>
Overview: 
           会员ID  会员等级
<span class="m">0</span>       <span class="m">100090</span>     <span class="m">3</span>
<span class="m">1</span>  <span class="m">10012905801</span>     <span class="m">1</span>
<span class="m">2</span>  <span class="m">10012935109</span>     <span class="m">1</span>
<span class="m">3</span>  <span class="m">10013498043</span>     <span class="m">1</span>
DESC: 
                会员ID           会员等级
count  <span class="m">1</span>.543850e+05  <span class="m">154385</span>.000000
mean   <span class="m">2</span>.980055e+10       <span class="m">2</span>.259701
std    <span class="m">1</span>.365654e+10       <span class="m">1</span>.346408
min    <span class="m">8</span>.100000e+01       <span class="m">1</span>.000000
<span class="m">25</span>%    <span class="m">2</span>.213894e+10       <span class="m">1</span>.000000
<span class="m">50</span>%    <span class="m">3</span>.833022e+10       <span class="m">2</span>.000000
<span class="m">75</span>%    <span class="m">3</span>.927932e+10       <span class="m">3</span>.000000
max    <span class="m">3</span>.954614e+10       <span class="m">5</span>.000000
NA records <span class="m">0</span>
Dtypes 会员ID    int64
会员等级    int64
dtype: object
</code></pre></div>
<ul>
<li>结果说明</li>
<li>每个sheet中的数据都能正常读取，无任何错误</li>
<li>日期列（提交日期）已经被自动识别为日期格式，后期不必转换</li>
<li>订单金额的分布是不均匀的，里面有明显的极大值<ul>
<li>例如2016年的数据中，最大值为174900，最小值仅为0.1</li>
<li>极大极小值相差过大，数据会受极值影响</li>
</ul>
</li>
<li>订单金额中的最小值包括0、0.1这样的金额，可能为非正常订单，与业务方沟通后确认<ul>
<li>最大值的订单金额有效，通常是客户一次性购买多个大家电商品</li>
<li>而订单金额为0.1元这类使用优惠券支付的订单，没有实际意义</li>
<li>除此之外，所有低于1元的订单均有这个问题，因此需要在后续处理中去掉</li>
</ul>
</li>
<li>有的表中存在缺失值记录，但数量不多，选择丢弃或填充均可</li>
</ul>
</blockquote>
<ul>
<li><strong>数据预处理</strong></li>
</ul>
<div class="highlight"><pre><span></span><code><span class="c1"># 去除缺失值和异常值</span>
<span class="k">for</span> <span class="n">ind</span><span class="p">,</span><span class="n">each_data</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">sheet_datas</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]):</span>    
    <span class="n">sheet_datas</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span> <span class="o">=</span> <span class="n">each_data</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span><span class="c1"># 丢弃缺失值记录</span>
    <span class="n">sheet_datas</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span> <span class="o">=</span> <span class="n">each_data</span><span class="p">[</span><span class="n">each_data</span><span class="p">[</span><span class="s1">&#39;订单金额&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">]</span><span class="c1"># 丢弃订单金额&lt;=1的记录</span>
    <span class="n">sheet_datas</span><span class="p">[</span><span class="n">ind</span><span class="p">][</span><span class="s1">&#39;max_year_date&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">each_data</span><span class="p">[</span><span class="s1">&#39;提交日期&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="c1"># 增加一列最大日期值</span>
</code></pre></div>
<blockquote>
<ul>
<li>通过for循环配合enumerate方法，获得每个可迭代元素的索引和具体值</li>
<li>处理缺失值和异常值只针对订单数据，因此sheet_datas通过索引实现不包含最后一个对象（即会员等级表）</li>
<li>直接将each_data使用dropna丢弃缺失值后的dataframe代原来sheet_datas中的dataframe</li>
<li>使用each_data[each_data['订单金额']&gt;1]来过滤出包含订单金额&gt;1的记录数，然后替换原来sheet_datas中的dataframe</li>
<li>最后一行代码的目的是在每个年份的数据中新增一列max_year_date，通过each_data['提交日期'].max()获取一年中日期的最大值，这样方便后续针对每年的数据分别做RFM计算，而不是针对4年的数据统一做RFM计算。</li>
</ul>
</blockquote>
<div class="highlight"><pre><span></span><code><span class="c1"># 汇总所有数据</span>
<span class="n">data_merge</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">sheet_datas</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="c1"># 获取各自年份数据</span>
<span class="n">data_merge</span><span class="p">[</span><span class="s1">&#39;date_interval&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data_merge</span><span class="p">[</span><span class="s1">&#39;max_year_date&#39;</span><span class="p">]</span><span class="o">-</span><span class="n">data_merge</span><span class="p">[</span><span class="s1">&#39;提交日期&#39;</span><span class="p">]</span>
<span class="n">data_merge</span><span class="p">[</span><span class="s1">&#39;year&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data_merge</span><span class="p">[</span><span class="s1">&#39;提交日期&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">year</span>
<span class="c1"># 转换日期间隔为数字</span>
<span class="n">data_merge</span><span class="p">[</span><span class="s1">&#39;date_interval&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data_merge</span><span class="p">[</span><span class="s1">&#39;date_interval&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">days</span><span class="p">)</span>
<span class="n">data_merge</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</code></pre></div>
<blockquote>
<p><font color='red'>输出结果：</font></p>
<table>
<thead>
<tr>
<th align="right"></th>
<th align="right">会员ID</th>
<th align="right">订单号</th>
<th align="right">提交日期</th>
<th align="right">订单金额</th>
<th align="right">max_year_date</th>
<th align="right">date_interval</th>
<th align="right">year</th>
</tr>
</thead>
<tbody>
<tr>
<td align="right">0</td>
<td align="right">15278002468</td>
<td align="right">3000304681</td>
<td align="right">2015-01-01</td>
<td align="right">499.0</td>
<td align="right">2015-12-31</td>
<td align="right">364</td>
<td align="right">2015</td>
</tr>
<tr>
<td align="right">1</td>
<td align="right">39236378972</td>
<td align="right">3000305791</td>
<td align="right">2015-01-01</td>
<td align="right">2588.0</td>
<td align="right">2015-12-31</td>
<td align="right">364</td>
<td align="right">2015</td>
</tr>
<tr>
<td align="right">2</td>
<td align="right">38722039578</td>
<td align="right">3000641787</td>
<td align="right">2015-01-01</td>
<td align="right">498.0</td>
<td align="right">2015-12-31</td>
<td align="right">364</td>
<td align="right">2015</td>
</tr>
<tr>
<td align="right">3</td>
<td align="right">11049640063</td>
<td align="right">3000798913</td>
<td align="right">2015-01-01</td>
<td align="right">1572.0</td>
<td align="right">2015-12-31</td>
<td align="right">364</td>
<td align="right">2015</td>
</tr>
<tr>
<td align="right">4</td>
<td align="right">35038752292</td>
<td align="right">3000821546</td>
<td align="right">2015-01-01</td>
<td align="right">10.1</td>
<td align="right">2015-12-31</td>
<td align="right">364</td>
<td align="right">2015</td>
</tr>
</tbody>
</table>
<ul>
<li>汇总所有数据: 将4年的数据使用pd.concat方法合并为一个完整的dataframe data_merge，后续的所有计算都能基于同一个dataframe进行，而不用写循环代码段对每个年份的数据单独计算</li>
<li>获取各自年份数据:<ul>
<li>先计算各自年份的最大日期与每个行的日期的差，得到日期间隔</li>
<li>再增加一列新的字段，为每个记录行发生的年份，使用data_merge['提交日期'].dt.year实现</li>
</ul>
</li>
<li>关于pandas的 datetime类型<ul>
<li>dt是pandas中Series时间序列datetime类属性的访问对象</li>
<li>除了代码中用到的year外，还包括：date、dayofweek、dayofyear、days_in_month、freq、days、hour、microsecond、minute、month、quarter、second、time、week、weekday、weekday_name、weekofyear等</li>
</ul>
</li>
<li>转换日期间隔为数字：data_merge['date_interval'].apply(lambda x: x.days) 是将data_merge['date_interval']的时间间隔转换为数值型计算对象，这里使用了apply方法。Apply方法是对某个Pandas对象（dataframe或Series）使用自定义函数</li>
</ul>
</blockquote>
<div class="highlight"><pre><span></span><code><span class="c1"># 按会员ID做汇总</span>
<span class="n">rfm_gb</span> <span class="o">=</span> <span class="n">data_merge</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;year&#39;</span><span class="p">,</span><span class="s1">&#39;会员ID&#39;</span><span class="p">],</span><span class="n">as_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span>
    <span class="p">{</span><span class="s1">&#39;date_interval&#39;</span><span class="p">:</span> <span class="s1">&#39;min&#39;</span><span class="p">,</span>  <span class="c1"># 计算最近一次订单时间</span>
     <span class="s1">&#39;提交日期&#39;</span><span class="p">:</span> <span class="s1">&#39;count&#39;</span><span class="p">,</span> <span class="c1"># 计算订单频率</span>
     <span class="s1">&#39;订单金额&#39;</span><span class="p">:</span> <span class="s1">&#39;sum&#39;</span><span class="p">})</span>  <span class="c1"># 计算订单总金额</span>
<span class="c1"># 重命名列名</span>
<span class="n">rfm_gb</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span>  <span class="p">[</span><span class="s1">&#39;year&#39;</span><span class="p">,</span><span class="s1">&#39;会员ID&#39;</span><span class="p">,</span><span class="s1">&#39;r&#39;</span><span class="p">,</span><span class="s1">&#39;f&#39;</span><span class="p">,</span><span class="s1">&#39;m&#39;</span><span class="p">]</span>
<span class="n">rfm_gb</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</code></pre></div>
<blockquote>
<p><font color='red'>输出结果：</font></p>
<table>
<thead>
<tr>
<th align="right"></th>
<th align="right">year</th>
<th align="right">会员ID</th>
<th align="right">r</th>
<th align="right">f</th>
<th align="right">m</th>
</tr>
</thead>
<tbody>
<tr>
<td align="right">0</td>
<td align="right">2015</td>
<td align="right">267</td>
<td align="right">197</td>
<td align="right">2</td>
<td align="right">105.0</td>
</tr>
<tr>
<td align="right">1</td>
<td align="right">2015</td>
<td align="right">282</td>
<td align="right">251</td>
<td align="right">1</td>
<td align="right">29.7</td>
</tr>
<tr>
<td align="right">2</td>
<td align="right">2015</td>
<td align="right">283</td>
<td align="right">340</td>
<td align="right">1</td>
<td align="right">5398.0</td>
</tr>
<tr>
<td align="right">3</td>
<td align="right">2015</td>
<td align="right">343</td>
<td align="right">300</td>
<td align="right">1</td>
<td align="right">118.0</td>
</tr>
<tr>
<td align="right">4</td>
<td align="right">2015</td>
<td align="right">525</td>
<td align="right">37</td>
<td align="right">3</td>
<td align="right">213.0</td>
</tr>
</tbody>
</table>
<ul>
<li>上面代码框中的第一行代码，是基于年份和会员ID，分别做RFM原始值的聚合计算</li>
<li>这里使用groupby分组，以year和会员ID为联合主键，设置as_index=False意味着year和会员ID不作为index列，而是普通的数据框结果列。后面的agg方法实际上是一个“批量”聚合功能的函数，它实现了对date_interval、提交日期、订单金额三列分别以min、count、sum做聚合计算的功能。否则，我们需要分别写3条goupby来实现3个聚合计算</li>
</ul>
</blockquote>
<ul>
<li><strong>确定RFM划分区间</strong>
  在做RFM划分时，基本逻辑是分别对R、F、M做离散化操作，然后再计算RFM。而离散化本身有多种方法可选，由于我们要对数据做RFM离散化，因此需要先看下数据的基本分布状态</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="c1"># 查看数据分布</span>
<span class="n">desc_pd</span> <span class="o">=</span> <span class="n">rfm_gb</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">2</span><span class="p">:]</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span><span class="o">.</span><span class="n">T</span>
<span class="n">desc_pd</span>
</code></pre></div>
<blockquote>
<p><font color='red'>输出结果：</font></p>
<table>
<thead>
<tr>
<th align="right"></th>
<th align="right">count</th>
<th align="right">mean</th>
<th align="right">std</th>
<th align="right">min</th>
<th align="right">25%</th>
<th align="right">50%</th>
<th align="right">75%</th>
<th align="right">max</th>
</tr>
</thead>
<tbody>
<tr>
<td align="right">r</td>
<td align="right">148591.0</td>
<td align="right">165.524043</td>
<td align="right">101.988472</td>
<td align="right">0.0</td>
<td align="right">79.0</td>
<td align="right">156.0</td>
<td align="right">255.0</td>
<td align="right">365.0</td>
</tr>
<tr>
<td align="right">f</td>
<td align="right">148591.0</td>
<td align="right">1.365002</td>
<td align="right">2.626953</td>
<td align="right">1.0</td>
<td align="right">1.0</td>
<td align="right">1.0</td>
<td align="right">1.0</td>
<td align="right">130.0</td>
</tr>
<tr>
<td align="right">m</td>
<td align="right">148591.0</td>
<td align="right">1323.741329</td>
<td align="right">3753.906883</td>
<td align="right">1.5</td>
<td align="right">69.0</td>
<td align="right">189.0</td>
<td align="right">1199.0</td>
<td align="right">206251.8</td>
</tr>
</tbody>
</table>
</blockquote>
<div class="highlight"><pre><span></span><code><span class="c1"># 定义区间边界</span>
<span class="n">r_bins</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">79</span><span class="p">,</span><span class="mi">255</span><span class="p">,</span><span class="mi">365</span><span class="p">]</span> <span class="c1"># 注意起始边界小于最小值</span>
<span class="n">f_bins</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">130</span><span class="p">]</span> <span class="c1"># 通过和业务部门沟通得到</span>
<span class="n">m_bins</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">69</span><span class="p">,</span><span class="mi">1199</span><span class="p">,</span><span class="mi">206252</span><span class="p">]</span>
</code></pre></div>
<ul>
<li>
<p>从基本概要看出</p>
<ul>
<li>汇总后的数据总共有14万条</li>
<li>r和m的数据分布相对较为离散，表现在min、25%、50%、75%和max的数据没有特别集中</li>
<li>而从f（购买频率）则可以看出，大部分用户的分布都趋近于1，表现是从min到75%的分段值都是1且mean（均值）才为1.365</li>
<li>计划选择25%和75%作为区间划分的2个边界值</li>
</ul>
</li>
<li>
<p>f的分布情况说明</p>
<ul>
<li>r和m本身能较好地区分用户特征，而f则无法区分（大量的用户只有1个订单）</li>
<li>行业属性（家电）原因，1年购买1次比较普遍（其中包含新客户以及老客户在当年的第1次购买）</li>
<li>与业务部门沟通，划分时可以使用2和5来作为边界<ul>
<li>业务部门认为当年购买&gt;=2次可被定义为复购用户（而非累计订单的数量计算复购用户）</li>
<li>业务部门认为普通用户购买5次已经是非常高的次数，超过该次数就属于非常高价值用户群体</li>
</ul>
</li>
<li>该值是基于业务经验和日常数据报表获得的</li>
</ul>
</li>
<li>
<p>区间边界的基本原则如下</p>
<ul>
<li>中间2个边界值：r和m是分别通过25%和75%的值获取的，f是业务与数据部门定义的。</li>
<li>最小值边界：比各个维度的最小值小即可。</li>
<li>最大值边界：大于等于各个维度的最大值即可</li>
<li>最小值边界为什么要小于各个维度的最小值: <ul>
<li>这是由于在边界上的数据归属有一个基本准则，要么属于区间左侧，要么属于区间右侧。如，f_bins中的2处于边界上，要么属于左侧区间，要么属于右侧区间</li>
</ul>
</li>
<li>在后续使用pd.cut方法中，对于自定义边界实行的是左开右闭的原则，即数据属于右侧区间，f_bins中的2就属于右侧区间。最左侧的值是无法划分为任何区间的，因此，在定义最小值时，一定要将最小值的边界值</li>
<li>举例：[1，2，3，4，5]，假如数据划分的区间边界是[1，3，5]，即划分为2份<ul>
<li>其中的2 3被划分到(1，3]区间中</li>
<li>3 4 5被划分到(3，5]区间中</li>
<li>1无法划分到任何一个正常区间内</li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong>RFM计算过程</strong></p>
</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="c1"># RFM分箱得分</span>
<span class="n">rfm_gb</span><span class="p">[</span><span class="s1">&#39;r_score&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">cut</span><span class="p">(</span><span class="n">rfm_gb</span><span class="p">[</span><span class="s1">&#39;r&#39;</span><span class="p">],</span> <span class="n">r_bins</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">r_bins</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)])</span>  <span class="c1"># 计算R得分</span>
<span class="n">rfm_gb</span><span class="p">[</span><span class="s1">&#39;f_score&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">cut</span><span class="p">(</span><span class="n">rfm_gb</span><span class="p">[</span><span class="s1">&#39;f&#39;</span><span class="p">],</span> <span class="n">f_bins</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">f_bins</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)])</span>  <span class="c1"># 计算F得分</span>
<span class="n">rfm_gb</span><span class="p">[</span><span class="s1">&#39;m_score&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">cut</span><span class="p">(</span><span class="n">rfm_gb</span><span class="p">[</span><span class="s1">&#39;m&#39;</span><span class="p">],</span> <span class="n">m_bins</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">m_bins</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)])</span>  <span class="c1"># 计算M得分</span>
</code></pre></div>
<ul>
<li>每个rfm的过程使用了pd.cut方法，基于自定义的边界区间做划分</li>
<li>labels用来显示每个离散化后的具体值。F和M的规则是值越大，等级越高</li>
<li>而R的规则是值越小，等级越高，因此labels的规则与F和M相反</li>
<li>在labels指定时需要注意，4个区间的结果是划分为3份</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="c1">#计算RFM组合</span>
<span class="n">rfm_gb</span><span class="p">[</span><span class="s1">&#39;r_score&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">rfm_gb</span><span class="p">[</span><span class="s1">&#39;r_score&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">str</span><span class="p">)</span>
<span class="n">rfm_gb</span><span class="p">[</span><span class="s1">&#39;f_score&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">rfm_gb</span><span class="p">[</span><span class="s1">&#39;f_score&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">str</span><span class="p">)</span>
<span class="n">rfm_gb</span><span class="p">[</span><span class="s1">&#39;m_score&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">rfm_gb</span><span class="p">[</span><span class="s1">&#39;m_score&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">str</span><span class="p">)</span>
<span class="n">rfm_gb</span><span class="p">[</span><span class="s1">&#39;rfm_group&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">rfm_gb</span><span class="p">[</span><span class="s1">&#39;r_score&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">cat</span><span class="p">(</span><span class="n">rfm_gb</span><span class="p">[</span><span class="s1">&#39;f_score&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">cat</span><span class="p">(</span>
<span class="n">rfm_gb</span><span class="p">[</span><span class="s1">&#39;m_score&#39;</span><span class="p">])</span>
</code></pre></div>
<ul>
<li>
<p>将3列作为字符串组合为新的分组</p>
<ul>
<li>代码中，先针对3列使用astype方法将数值型转换为字符串型</li>
<li>然后使用pandas的字符串处理库str中的cat方法做字符串合并，该方法可以将右侧的数据合并到左侧</li>
<li>再连续使用两个str.cat方法得到总的R、F、M字符串组合</li>
</ul>
</li>
<li>
<p><strong>保存RFM结果到Excel</strong></p>
</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="n">rfm_gb</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="s1">&#39;sales_rfm_score1.xlsx&#39;</span><span class="p">)</span>  <span class="c1"># 保存数据为Excel</span>
</code></pre></div>
<ul>
<li><strong>写数据到数据库</strong></li>
</ul>
<div class="highlight"><pre><span></span><code><span class="c1"># 数据库信息</span>
<span class="n">config</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;host&#39;</span><span class="p">:</span> <span class="s1">&#39;192.168.88.161&#39;</span><span class="p">,</span>
          <span class="s1">&#39;user&#39;</span><span class="p">:</span> <span class="s1">&#39;root&#39;</span><span class="p">,</span>  <span class="c1"># 用户名</span>
          <span class="s1">&#39;password&#39;</span><span class="p">:</span> <span class="s1">&#39;123456&#39;</span><span class="p">,</span>  <span class="c1"># 密码</span>
          <span class="s1">&#39;port&#39;</span><span class="p">:</span> <span class="mi">3306</span><span class="p">,</span>  <span class="c1"># 端口，默认为3306</span>
          <span class="c1">#&#39;database&#39;: &#39;test&#39;,  # 数据库名称</span>
          <span class="s1">&#39;charset&#39;</span><span class="p">:</span> <span class="s1">&#39;utf8&#39;</span>  <span class="c1"># 字符编码</span>
          <span class="p">}</span>
<span class="n">con</span> <span class="o">=</span> <span class="n">pymysql</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="o">**</span><span class="n">config</span><span class="p">)</span>  <span class="c1"># 建立mysql连接</span>
<span class="n">cursor</span> <span class="o">=</span> <span class="n">con</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>  <span class="c1"># 获得游标</span>

<span class="c1"># 创建数据库</span>
<span class="n">create_database_sql</span> <span class="o">=</span> <span class="s2">&quot;create database if not exists test&quot;</span>
<span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">create_database_sql</span><span class="p">)</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="c1"># 数据库信息</span>
<span class="n">config</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;host&#39;</span><span class="p">:</span> <span class="s1">&#39;192.168.88.161&#39;</span><span class="p">,</span>  
          <span class="s1">&#39;user&#39;</span><span class="p">:</span> <span class="s1">&#39;root&#39;</span><span class="p">,</span>  <span class="c1"># 用户名</span>
          <span class="s1">&#39;password&#39;</span><span class="p">:</span> <span class="s1">&#39;123456&#39;</span><span class="p">,</span>  <span class="c1"># 密码</span>
          <span class="s1">&#39;port&#39;</span><span class="p">:</span> <span class="mi">3306</span><span class="p">,</span>  <span class="c1"># 端口，默认为3306</span>
          <span class="s1">&#39;database&#39;</span><span class="p">:</span> <span class="s1">&#39;test&#39;</span><span class="p">,</span>  <span class="c1"># 数据库名称</span>
          <span class="s1">&#39;charset&#39;</span><span class="p">:</span> <span class="s1">&#39;utf8&#39;</span>  <span class="c1"># 字符编码</span>
          <span class="p">}</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="c1"># 建表操作</span>
<span class="n">con</span> <span class="o">=</span> <span class="n">pymysql</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="o">**</span><span class="n">config</span><span class="p">)</span>  <span class="c1"># 建立mysql连接</span>
<span class="n">cursor</span> <span class="o">=</span> <span class="n">con</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>  <span class="c1"># 获得游标</span>
<span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;show tables&quot;</span><span class="p">)</span>  <span class="c1"># 查询表</span>
<span class="n">table_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">cursor</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()]</span>  <span class="c1"># 读出所有库</span>
<span class="c1"># 查找数据库是否存在目标表，如果没有则新建</span>
<span class="n">table_name</span> <span class="o">=</span> <span class="s1">&#39;sales_rfm_score&#39;</span>  <span class="c1"># 要写库的表名</span>
<span class="k">if</span> <span class="ow">not</span> <span class="n">table_name</span> <span class="ow">in</span> <span class="n">table_list</span><span class="p">:</span>  <span class="c1"># 如果目标表没有创建</span>
    <span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s1">&#39;&#39;&#39;</span>
<span class="s1">    CREATE TABLE </span><span class="si">%s</span><span class="s1"> (</span>
<span class="s1">    userid               VARCHAR(20),</span>
<span class="s1">    r_score               int(2),</span>
<span class="s1">    f_score              int(2),</span>
<span class="s1">    m_score              int(2),</span>
<span class="s1">    rfm_group              VARCHAR(10),</span>
<span class="s1">    insert_date              VARCHAR(20)</span>
<span class="s1">    )ENGINE=InnoDB DEFAULT CHARSET=utf8</span>
<span class="s1">    &#39;&#39;&#39;</span> <span class="o">%</span> <span class="n">table_name</span><span class="p">)</span>  <span class="c1"># 创建新表</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="c1"># 梳理数据</span>
<span class="n">write_db_data</span> <span class="o">=</span> <span class="n">rfm_gb</span><span class="p">[[</span><span class="s1">&#39;会员ID&#39;</span><span class="p">,</span><span class="s1">&#39;r_score&#39;</span><span class="p">,</span><span class="s1">&#39;f_score&#39;</span><span class="p">,</span><span class="s1">&#39;m_score&#39;</span><span class="p">,</span><span class="s1">&#39;rfm_group&#39;</span><span class="p">]]</span> <span class="c1"># 主要数据</span>
<span class="n">timestamp</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%Y-%m-</span><span class="si">%d</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">time</span><span class="o">.</span><span class="n">localtime</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()))</span>  <span class="c1"># 日期</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="c1"># 写库</span>
<span class="k">for</span> <span class="n">each_value</span> <span class="ow">in</span> <span class="n">write_db_data</span><span class="o">.</span><span class="n">values</span><span class="p">:</span>
    <span class="n">insert_sql</span> <span class="o">=</span> <span class="s2">&quot;INSERT INTO `</span><span class="si">%s</span><span class="s2">` VALUES (&#39;</span><span class="si">%s</span><span class="s2">&#39;,</span><span class="si">%s</span><span class="s2">,</span><span class="si">%s</span><span class="s2">,</span><span class="si">%s</span><span class="s2">,&#39;</span><span class="si">%s</span><span class="s2">&#39;,&#39;</span><span class="si">%s</span><span class="s2">&#39;)&quot;</span> <span class="o">%</span> \
                 <span class="p">(</span><span class="n">table_name</span><span class="p">,</span> <span class="n">each_value</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">each_value</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">each_value</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> \
                  <span class="n">each_value</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span><span class="n">each_value</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span>
                  <span class="n">timestamp</span><span class="p">)</span>  <span class="c1"># 写库SQL依据</span>
    <span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">insert_sql</span><span class="p">)</span>  <span class="c1"># 执行SQL语句，execute函数里面要用双引号</span>
    <span class="n">con</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>  <span class="c1"># 提交命令</span>
<span class="n">cursor</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>  <span class="c1"># 关闭游标</span>
<span class="n">con</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>  <span class="c1"># 关闭数据库连接</span>
</code></pre></div>
<ul>
<li>
<p><strong>RFM图形展示</strong></p>
</li>
<li>
<p>为了更好地了解不同周期下RFM分组人数的变化，通过3D柱形图展示结果</p>
</li>
<li>展示结果时只有3个维度，分别是年份、rfm分组和用户数量。</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="c1"># 图形数据汇总</span>
<span class="n">display_data</span> <span class="o">=</span> <span class="n">rfm_gb</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;rfm_group&#39;</span><span class="p">,</span><span class="s1">&#39;year&#39;</span><span class="p">],</span><span class="n">as_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)[</span><span class="s1">&#39;会员ID&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
<span class="n">display_data</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;rfm_group&#39;</span><span class="p">,</span><span class="s1">&#39;year&#39;</span><span class="p">,</span><span class="s1">&#39;number&#39;</span><span class="p">]</span>
<span class="n">display_data</span><span class="p">[</span><span class="s1">&#39;rfm_group&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">display_data</span><span class="p">[</span><span class="s1">&#39;rfm_group&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
<span class="n">display_data</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</code></pre></div>
<blockquote>
<p><font color='red'>输出结果：</font></p>
<table>
<thead>
<tr>
<th align="right"></th>
<th align="right">rfm_group</th>
<th align="right">year</th>
<th align="right">number</th>
</tr>
</thead>
<tbody>
<tr>
<td align="right">0</td>
<td align="right">111</td>
<td align="right">2015</td>
<td align="right">2180</td>
</tr>
<tr>
<td align="right">1</td>
<td align="right">111</td>
<td align="right">2016</td>
<td align="right">1498</td>
</tr>
<tr>
<td align="right">2</td>
<td align="right">111</td>
<td align="right">2017</td>
<td align="right">3169</td>
</tr>
<tr>
<td align="right">3</td>
<td align="right">111</td>
<td align="right">2018</td>
<td align="right">2271</td>
</tr>
<tr>
<td align="right">4</td>
<td align="right">112</td>
<td align="right">2015</td>
<td align="right">3811</td>
</tr>
</tbody>
</table>
</blockquote>
<ul>
<li>第1行代码使用数据框的groupby以rfm_group和year为联合对象，以会员ID会为计算维度做计数，得到每个RFM分组、年份下的会员数量</li>
<li>第2行代码对结果列重命名</li>
<li>第3行代码将rfm分组列转换为int32形式</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="c1"># 显示图形</span>
<span class="kn">from</span> <span class="nn">pyecharts.charts</span> <span class="kn">import</span> <span class="n">Bar3D</span>
<span class="kn">from</span> <span class="nn">pyecharts</span> <span class="kn">import</span> <span class="n">options</span> <span class="k">as</span> <span class="n">opts</span>
<span class="kn">from</span> <span class="nn">pyecharts.commons.utils</span> <span class="kn">import</span> <span class="n">JsCode</span>
<span class="n">range_color</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;#313695&#39;</span><span class="p">,</span> <span class="s1">&#39;#4575b4&#39;</span><span class="p">,</span> <span class="s1">&#39;#74add1&#39;</span><span class="p">,</span> <span class="s1">&#39;#abd9e9&#39;</span><span class="p">,</span> <span class="s1">&#39;#e0f3f8&#39;</span><span class="p">,</span> <span class="s1">&#39;#ffffbf&#39;</span><span class="p">,</span>
               <span class="s1">&#39;#fee090&#39;</span><span class="p">,</span> <span class="s1">&#39;#fdae61&#39;</span><span class="p">,</span> <span class="s1">&#39;#f46d43&#39;</span><span class="p">,</span> <span class="s1">&#39;#d73027&#39;</span><span class="p">,</span> <span class="s1">&#39;#a50026&#39;</span><span class="p">]</span>
<span class="n">range_max</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">display_data</span><span class="p">[</span><span class="s1">&#39;number&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">())</span>
<span class="n">c</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">Bar3D</span><span class="p">()</span><span class="c1">#设置了一个3D柱形图对象</span>
    <span class="o">.</span><span class="n">add</span><span class="p">(</span>
        <span class="s2">&quot;&quot;</span><span class="p">,</span><span class="c1">#标题</span>
        <span class="p">[</span><span class="n">d</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span> <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">display_data</span><span class="o">.</span><span class="n">values</span><span class="p">],</span><span class="c1">#数据</span>
        <span class="n">xaxis3d_opts</span><span class="o">=</span><span class="n">opts</span><span class="o">.</span><span class="n">Axis3DOpts</span><span class="p">(</span> <span class="n">type_</span><span class="o">=</span><span class="s2">&quot;category&quot;</span><span class="p">,</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;分组名称&#39;</span><span class="p">),</span><span class="c1">#x轴数据类型，名称</span>
        <span class="n">yaxis3d_opts</span><span class="o">=</span><span class="n">opts</span><span class="o">.</span><span class="n">Axis3DOpts</span><span class="p">(</span> <span class="n">type_</span><span class="o">=</span><span class="s2">&quot;category&quot;</span><span class="p">,</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;年份&#39;</span><span class="p">),</span><span class="c1">#y轴数据类型，名称</span>
        <span class="n">zaxis3d_opts</span><span class="o">=</span><span class="n">opts</span><span class="o">.</span><span class="n">Axis3DOpts</span><span class="p">(</span><span class="n">type_</span><span class="o">=</span><span class="s2">&quot;value&quot;</span><span class="p">,</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;会员数量&#39;</span><span class="p">),</span><span class="c1">#z轴数据类型，名称</span>
    <span class="p">)</span>
    <span class="o">.</span><span class="n">set_global_opts</span><span class="p">(</span><span class="c1">#设置颜色，及不同取值对应的颜色</span>
        <span class="n">visualmap_opts</span><span class="o">=</span><span class="n">opts</span><span class="o">.</span><span class="n">VisualMapOpts</span><span class="p">(</span><span class="n">max_</span><span class="o">=</span><span class="n">range_max</span><span class="p">,</span><span class="n">range_color</span><span class="o">=</span><span class="n">range_color</span><span class="p">),</span>
        <span class="n">title_opts</span><span class="o">=</span><span class="n">opts</span><span class="o">.</span><span class="n">TitleOpts</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;RFM分组结果&quot;</span><span class="p">),</span><span class="c1">#设置标题</span>
    <span class="p">)</span>
<span class="p">)</span>
<span class="n">c</span><span class="o">.</span><span class="n">render</span><span class="p">()</span> <span class="c1">#在html中显示</span>
</code></pre></div>
<blockquote>
<p><font color='red'>输出结果：</font></p>
<p><img alt="image-20200822212014030" src="img/pyecharts_rfm.png" /></p>
</blockquote>
<ul>
<li>输出3D图像中<ul>
<li>X轴为RFM分组、Y轴为年份、Z轴为用户数量</li>
<li>该3D图可旋转、缩放，以便查看不同细节</li>
<li>调节左侧的滑块条，用来显示或不显示特定数量的分组结果</li>
</ul>
</li>
</ul>
<h3 id="25">2.5 案例结论<a class="headerlink" href="#25" title="Permanent link">&para;</a></h3>
<ul>
<li>
<p><strong>基于图形的交互式分析</strong></p>
</li>
<li>
<p>重点人群分布：</p>
<ul>
<li>在整个分组中，212群体的用户是相对集中且变化最大的</li>
<li>从2016年到2017年用户群体数量变化不大，但到2018年增长了近一倍</li>
<li>这部分人群将作为重点分析人群</li>
</ul>
</li>
<li>
<p>重点分组分布：</p>
<ul>
<li>除了212人群外，312、213、211及112人群都在各个年份占据很大数量</li>
<li>虽然各自规模不大，但组合起来的总量超过212本身，也要重点做分析。</li>
<li>如果拖动左侧的滑块，仅过滤出用户数量在4085以内的分组结果。观察图形发现，很多分组的人群非常少，甚至没有人</li>
</ul>
</li>
<li>
<p><strong>基于RFM分组结果的分析</strong>
  通过RFM分组的Excel结果数据，我们将更进一步确定要分析的主要目标群体。
  我们打开导出的sales_rfm_score.xlsx，然后建立数据透视表，从Excel中得出的数据可以看出，与我们用Python代码分析的结果是一致的</p>
</li>
</ul>
<p><img alt="rfm7" src="img/rfm7.png" /></p>
<ul>
<li>
<p><strong>RFM用户特征分析</strong></p>
</li>
<li>
<p>经过上面的分析，得到了要分析的重点客户群体。可根据用户的量级分为两类</p>
<ul>
<li>第1类是用户群体占比超过10%的群体</li>
<li>第2类是占比在个位数的群体。这两类人由于量级不同，因此需要分别有针对性的策略场景。</li>
<li>除此以外，我们还会增加第3类人群，虽然从用户量级上小，但是单个人的价值度非常高。</li>
</ul>
</li>
<li>第1类人群：占比超过10%的群体。由于这类人群基数大，必须采取批量操作和运营的方式落地运营策略，一般需要通过系统或产品实现，而不能主要依赖于人工<ul>
<li>212：可发展的一般性群体。这类群体购买新近度和订单金额一般，且购买频率低。考虑到其最大的群体基础，以及在新近度和订单金额上都可以，因此可采取常规性的礼品兑换和赠送、购物社区活动、签到、免运费等手段维持并提升其消费状态。</li>
<li>211：可发展的低价值群体。这类群体相对于212群体在订单金额上表现略差，因此在211群体策略的基础上，可以增加与订单相关的刺激措施，例如组合商品优惠券发送、积分购买商品等</li>
<li>312：有潜力的一般性群体。这类群体购买新近度高，说明最近一次购买发生在很短时间之前，群体对于公司尚有比较熟悉的接触渠道和认知状态；购物频率低，说明对网站的忠诚度一般；订单金额处于中等层级，说明其还具有可提升的空间。因此，可以借助其最近购买的商品，为其定制一些与上次购买相关的商品，通过向上销售等策略提升购买频次和订单金额</li>
<li>112：可挽回的一般性群体。这类群体购买新近度较低，说明距离上次购买时间较长，很可能用户已经处于沉默或预流失、流失阶段；购物频率低，说明对网站的忠诚度一般；订单金额处于中等层级，说明其还可能具有可提升的空间。因此，对这部分群体的策略首先是通过多种方式（例如邮件、短信等）触达客户并挽回，然后通过针对流失客户的专享优惠（例如流失用户专享优惠券）措施促进其消费。在此过程中，可通过增加接触频次和刺激力度的方式，增加用户的回访、复购以及订单价值回报</li>
<li>213：可发展的高价值群体。这类人群发展的重点是提升购物频率，因此可指定不同的活动或事件来触达用户，促进其回访和购买，例如不同的节日活动、每周新品推送、高价值客户专享商品等。</li>
</ul>
</li>
<li>第2类人群：占比为1%～10%的群体。这部分人群数量适中，在落地时无论是产品还是人工都可接入<ul>
<li>311：有潜力的低价值群体。这部分用户与211群体类似，但在购物新近度上更好，因此对其可采取相同的策略。除此以外，在这类群体的最近接触渠道上可以增加营销或广告资源投入，通过这些渠道再次将客户引入网站完成消费。</li>
<li>111：这是一类在各个维度上都比较差的客户群体。一般情况下，会在其他各个群体策略和管理都落地后才考虑他们。主要策略是先通过多种策略挽回客户，然后为客户推送与其类似的其他群体，或者当前热销的商品或折扣非常大的商品。在刺激消费时，可根据其消费水平、品类等情况，有针对性地设置商品暴露条件，先在优惠券及优惠商品的综合刺激下使其实现消费，再考虑消费频率以及订单金额的提升。</li>
<li>313：有潜力的高价值群体。这类群体的消费新近度高且订单金额高，但购买频率低，因此只要提升其购买频次，用户群体的贡献价值就会倍增。提升购买频率上，除了在其最近一次的接触渠道上增加曝光外，与最近一次渠道相关的其他关联访问渠道也要考虑增加营销资源。另外，213中的策略也要组合应用其中</li>
<li>113：可挽回的高价值群体。这类群体与112群体类似，但订单金额贡献更高，因此除了应用112中的策略外，可增加部分人工的参与来挽回这些高价值客户，例如线下访谈、客户电话沟通等</li>
</ul>
</li>
<li>第3类群体：占比非常少，但却是非常重要的群体<ul>
<li>333：绝对忠诚的高价值群体。虽然用户绝对数量只有355，但由于其各方面表现非常突出，因此可以倾斜更多的资源，例如设计VIP服务、专享服务、绿色通道等。另外，针对这部分人群的高价值附加服务的推荐也是提升其价值的重点策略</li>
<li>233、223和133：一般性的高价值群体。这类群体的主要着手点是提升新近购买度，即促进其实现最近一次的购买，可通过DM、电话、客户拜访、线下访谈、微信、电子邮件等方式直接建立用户挽回通道，以挽回这部分高价值用户</li>
<li>322、323和332：有潜力的普通群体。这类群体最近刚完成购买，需要提升的是购买频次及购买金额。因此可通过交叉销售、个性化推荐、向上销售、组合优惠券、打包商品销售等策略，提升其单次购买的订单金额及促进其重复购买</li>
</ul>
</li>
</ul>
<h3 id="26">2.6 案例应用<a class="headerlink" href="#26" title="Permanent link">&para;</a></h3>
<ul>
<li>针对上述得到的分析结论，会员部门采取了以下措施<ul>
<li>分别针3类群体，按照公司实际运营需求和当前目标，制定了不同的群体落地的排期</li>
<li>录入数据库的RFM得分数据已经应用到其他数据模型中，成为建模输入的关键维度特征之一</li>
</ul>
</li>
</ul>
<h3 id="27">2.7 案例注意点<a class="headerlink" href="#27" title="Permanent link">&para;</a></h3>
<ul>
<li>
<p>不同品类、行业对于RFM的依赖度是有差异的，即使是一个公司在不同的发展阶段和周期下，3个维度的优先级上也会有调整</p>
<ul>
<li>大家电等消费周期较长的行业，R和M会更重要一些</li>
<li>快消等消费周期短且快的行业，更看重R和F</li>
<li>具体要根据当前运营需求与业务部门沟通</li>
</ul>
</li>
<li>
<p>对R、F、M区间的划分是一个离散化的过程，具体需要划分为几个区间需要与业务方确认</p>
<ul>
<li>本案例划分为3个区间，结果对于业务分析而言有些多，意味着业务方需要制定十几套甚至更多的策略</li>
<li>如果业务方要求简化，也可以划分为2个区间，这样出来的分组数最多有8组，策略制定更加简单</li>
<li>具体是划分为2个还是3个，取决于当前业务方有多少资源可以投入到这个事情中来。</li>
</ul>
</li>
<li>
<p>R、F、M的权重打分</p>
<ul>
<li>除了案例中提到的建模方式外，结合业务经验的专家打分法也是常用的思路，这时推荐结合AHP层次分析法打分，这样出来的权重结果更加科学、严谨。</li>
<li>虽然订单数据库中的数据质量相对较高，但可能由于数据采集、数据库同步、ETL、查询、误操作等问题，还是会导致NA值的出现，而NA值的处理非常重要。</li>
<li>R、F、M三个维度的处理（包括计算、离散化、组合、转换）之前都需要注意其数据类型和格式，尤其是有关时间项的转换操作应提前完成</li>
</ul>
</li>
</ul>
<h2 id="_2">小结<a class="headerlink" href="#_2" title="Permanent link">&para;</a></h2>
<ul>
<li>RFM模型是经典的一种用户分群方法，操作起来比较简单，如果数据量不是很大的时候，直接使用Excel就可以实现</li>
<li>RFM并不是在所有业务场景下都可以使用，一般用于零售行业（复购率相对高的行业）</li>
<li>使用Python的cut方法对数据进行分组，需要注意分组区间默认是左开右闭</li>
<li>使用Pyecharts可以方便的绘制出可以交互的3D图，在修改弹出提示信息内容时，需要注意字符串拼接的格式</li>
</ul>

              
            </article>
          </div>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="页脚">
      
        
        <a href="../06_%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E7%BB%98%E5%9B%BE/04_Seaborn%E7%BB%98%E5%9B%BE.html" class="md-footer__link md-footer__link--prev" aria-label="上一页: 4 Seaborn 可视化" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                上一页
              </span>
              4 Seaborn 可视化
            </div>
          </div>
        </a>
      
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "..", "features": [], "translations": {"clipboard.copy": "\u590d\u5236", "clipboard.copied": "\u5df2\u590d\u5236", "search.config.lang": "ja", "search.config.pipeline": "trimmer, stemmer", "search.config.separator": "[\\uff0c\\u3002]+", "search.placeholder": "\u641c\u7d22", "search.result.placeholder": "\u952e\u5165\u4ee5\u5f00\u59cb\u641c\u7d22", "search.result.none": "\u6ca1\u6709\u627e\u5230\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.one": "\u627e\u5230 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.other": "# \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.more.one": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.more.other": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 # \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.term.missing": "\u7f3a\u5c11", "select.version.title": "\u9009\u62e9\u5f53\u524d\u7248\u672c"}, "search": "../assets/javascripts/workers/search.22074ed6.min.js"}</script>
    
    
      <script src="../assets/javascripts/bundle.1514a9a0.min.js"></script>
      
        <script src="../js/extra.js"></script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML"></script>
      
    
  </body>
</html>